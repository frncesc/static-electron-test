(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{RnhZ:function(e,t,n){var r={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id="RnhZ"},b1Nn:function(e,t,n){"use strict";n.r(t);var r,a=n("q1tI"),o=n.n(a),i=n("i8i4"),c=n.n(i),s=n("iC7s");function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.TogglePreview="togglePreview",e.ToggleSettingsSidebar="toggleSettingsSidebar",e.ToggleTrash="toggleTrash",e.TogglePageSettings="togglePageSettings",e.SetProjectSettingsState="setProjectSettingsState",e.ToggleHelpPopup="toggleHelpPopup",e.OpenSettingsForPage="openSettingsForPage",e.ClosePageSettings="closePageSettings",e.TogglePageSelection="togglePageSelection",e.SetDragging="setDragging"}(r||(r={}));var g,f=o.a.createContext({}),m=function(e){var t=e.magModel,n=e.router,i=e.children,c={inPreview:!!n.previewMode,isSettingsOpened:!1,isTrashOpened:!1,isPageSettingsOpened:!1,isProjectSettingsOpened:!1,isHelpPopupOpened:!1,selectedPages:{},isDragging:!1},s=function(e,t){var n=d({},e.selectedPages);return n[t]?delete n[t]:n[t]=!0,n},u=l(Object(a.useReducer)((function(e,t){switch(t.type){case r.TogglePreview:return d({},e,{inPreview:!e.inPreview});case r.ToggleSettingsSidebar:return d({},e,{isSettingsOpened:!e.isSettingsOpened});case r.ToggleTrash:return d({},e,{isTrashOpened:!e.isTrashOpened});case r.TogglePageSettings:return d({},e,{isPageSettingsOpened:!e.isPageSettingsOpened});case r.SetProjectSettingsState:return d({},e,{isProjectSettingsOpened:t.payload});case r.ToggleHelpPopup:return d({},e,{isHelpPopupOpened:!e.isHelpPopupOpened});case r.TogglePageSelection:return d({},e,{selectedPages:s(e,t.payload)});case r.SetDragging:return d({},e,{isDragging:t.payload});default:return e}}),c),2),p=u[0],g=u[1];return o.a.createElement(f.Provider,{value:d({},p,{dispatch:g,setPageVisibility:function(e,n){return new Promise((function(r,a){var o=t.getPage(e);o||r(),o.save({hidden:n}).done((function(e){r(e)})).fail((function(e){a(e.responseJSON)}))}))},validatePageUri:function(e,n){var r=t.getPage(e);return r?r.validate({uri:n}):{pageNotFound:!0}}})},i)},h=function(e,t,n,r){var a=n.findIndex((function(t){return t.num===e})),o=a>=0?n[a]:null,i=e+1;if(o&&o.children&&o.children.length&&r[o._id]&&!r[o._id].collapsed){var c=n[a+1];i=c?c.num:o.children[o.children.length-1].num+1}var s=null;if(o&&o.children&&o.children.length&&r[o._id]&&r[o._id].collapsed)s=o._id;else if(!o){var l=t.find((function(t){return t.num===e}));l&&(s=l.parentPage)}return{newPageNum:i,newPageParentId:s}},b=n("vOnD");!function(e){e.Top="top",e.Right="right",e.Bottom="bottom",e.Left="left"}(g||(g={}));var y=function(e,t){var n=Object(a.useRef)(null),r=function(e){e.preventDefault(),e.target&&n.current&&!n.current.contains(e.target)&&t()};return Object(a.useEffect)((function(){return e?window.addEventListener("click",r):window.removeEventListener("click",r),function(){window.removeEventListener("click",r)}}),[e]),n},v=Object(b.d)(s.i).withConfig({displayName:"Popup___StyledBox"})(["background-color:rgba(40,40,40,0.92);transform:",";transition:0.3s transform ease;"],(function(e){return e._css})),w=Object(b.d)(s.i).withConfig({displayName:"Popup___StyledBox2"})(["display:",";",""],(function(e){return e._css2}),(function(e){return e._css3})),j=Object(a.forwardRef)((function(e,t){var n=e.isShown,r=e.coords,i=e.width,l=e.height,u=e.zIndex,d=e.transform,p=e.placement,f=e.children;if(!n)return null;var m=Object(a.useMemo)((function(){var e="";switch(p){case g.Bottom:e="bottom: -16px; left: 24px; transform: rotate(90deg);"}return e}),[p]);return c.a.createPortal(o.a.createElement(v,{ref:t,width:"number"==typeof i?"".concat(i,"px"):"auto",height:"number"==typeof l?"".concat(l,"px"):"auto",position:"absolute",top:"number"==typeof r.top?"".concat(r.top,"px"):"auto",right:"number"==typeof r.right?"".concat(r.right,"px"):"auto",bottom:"number"==typeof r.bottom?"".concat(r.bottom,"px"):"auto",left:"number"==typeof r.left?"".concat(r.left,"px"):"auto",zIndex:u||8e3,borderRadius:"m",_css:d||"none"},f,o.a.createElement(w,{position:"absolute",_css2:p?"block":"none",_css3:m},o.a.createElement(s.cb,{color:"black"}))),document.body)}));j.displayName="Popup";var S,O=j,P=n("K6JF"),x=function(e){var t=e.showTour,n=new P.a;return o.a.createElement(s.t,{width:"100%",height:"100%",flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start",px:3,py:15},o.a.createElement(s.j,{color:"white",textStyle:"subheading",onClick:function(){t()}},"Quick tour"),o.a.createElement(s.j,{color:"white",textStyle:"subheading",onClick:function(){window.RM.analytics&&window.RM.analytics.sendEvent("Constructor Help Open","Learn shortcuts"),n.show()}},"Shortcuts"),o.a.createElement(s.j,{color:"white",textStyle:"subheading",as:"a",href:"https://help.readymag.com",target:"_blank",onClick:function(){window.RM.analytics&&window.RM.analytics.sendEvent("Constructor Help Open","Learn R/m"),window.open("https://help.readymag.com","_blank")}},"Learn Readymag"))},_=b.d.button.withConfig({displayName:"question-button__StyledButton"})(["padding:0;background:transparent;border:0;border-image:none;outline:none;cursor:pointer;"]),E=function(e){var t=e.onClick;return o.a.createElement(_,{onClick:t},o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"6px",height:"10px",viewBox:"0 0 6 10"},o.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},o.a.createElement("g",{transform:"translate(-994.000000, -39.000000)",fill:"#808080",fillRule:"nonzero"},o.a.createElement("path",{d:"M994.197187,41.8300781 C994.224531,41.1308559 994.46867,40.5634787 994.929609,40.1279297 C995.390549,39.6923806 996.033121,39.4746094 996.857344,39.4746094 C997.626879,39.4746094 998.250896,39.6796854 998.729414,40.0898438 C999.207932,40.5000021 999.447187,41.0253874 999.447187,41.6660156 C999.447187,42.5097698 999.037035,43.1777319 998.216719,43.6699219 C997.841717,43.8925792 997.58586,44.0986319 997.449141,44.2880859 C997.312421,44.47754 997.244062,44.7207016 997.244062,45.0175781 L997.244062,45.3691406 L996.031172,45.3691406 L996.025312,44.9238281 C996.009687,44.5097636 996.091718,44.1591811 996.271406,43.8720703 C996.451095,43.5849595 996.746014,43.3183606 997.156172,43.0722656 C997.515549,42.8574208 997.765546,42.6513682 997.906172,42.4541016 C998.046798,42.256835 998.117109,42.0117202 998.117109,41.71875 C998.117109,41.3945296 997.996017,41.1279307 997.753828,40.9189453 C997.511639,40.7099599 997.19133,40.6054688 996.792891,40.6054688 C996.390545,40.6054688 996.066329,40.7158192 995.820234,40.9365234 C995.574139,41.1572277 995.437422,41.4550762 995.410078,41.8300781 L994.197187,41.8300781 Z M997.36125,47.8886719 C997.197187,48.0527352 996.980392,48.1347656 996.710859,48.1347656 C996.441327,48.1347656 996.222579,48.0527352 996.054609,47.8886719 C995.88664,47.7246086 995.802656,47.509767 995.802656,47.2441406 C995.802656,46.974608 995.88664,46.7568368 996.054609,46.5908203 C996.222579,46.4248039 996.441327,46.3417969 996.710859,46.3417969 C996.980392,46.3417969 997.198163,46.4238273 997.36418,46.5878906 C997.530196,46.7519539 997.613203,46.9707018 997.613203,47.2441406 C997.613203,47.509767 997.52922,47.7246086 997.36125,47.8886719 Z"})))))},C=b.d.a.withConfig({displayName:"SettingsHead___StyledA"})([".user-avatar-settings-sidebar{width:56px;height:56px;}"]),k=function(e){var t=e.projectSettingsPanel,n=Object(a.useContext)(Rn),i=Object(a.useContext)(f),c=y(i.isHelpPopupOpened,(function(){i.dispatch({type:r.ToggleHelpPopup})}));return Object(a.useEffect)((function(){i.isProjectSettingsOpened?(t.show(),t.once("hide",(function(){i.dispatch({type:r.SetProjectSettingsState,payload:!1})}))):t.shown&&t.hide()}),[i.isProjectSettingsOpened]),o.a.createElement(s.i,{p:2,mb:"3px"},o.a.createElement(s.t,{alignItems:"center",justifyContent:"flex-start",position:"relative"},o.a.createElement(s.i,{width:"56px",height:"56px",mr:2,bg:"darkGray",borderRadius:"round"},o.a.createElement(C,{href:"/".concat(n.project.user.uri)},o.a.createElement(s.L,{url:n.project.user.pic,name:n.project.user.name,className:"user-avatar-settings-sidebar"}))),o.a.createElement(s.M,{size:56,color:"darkGray","data-hovered":i.isProjectSettingsOpened,onClick:function(){return i.dispatch({type:r.SetProjectSettingsState,payload:!i.isProjectSettingsOpened})}},o.a.createElement(s.P,{width:34,height:30,color:"white"})),o.a.createElement(s.i,{position:"absolute",right:8,mt:"-1px"},o.a.createElement(E,{onClick:function(e){e.preventDefault(),e.stopPropagation(),i.dispatch({type:r.ToggleHelpPopup})},hovered:i.isHelpPopupOpened}))),o.a.createElement(O,{width:224,height:124,isShown:i.isHelpPopupOpened,coords:{top:16,right:8},ref:c},o.a.createElement(x,{showTour:n.showTour})))},T=n("wd/R"),N=n.n(T),R=n("xG9w"),A=n("wEEd"),I=n("y4v0"),D=4e3,B="0.3s",M=124,z=112,L=56,F=192,G=172,U=88;!function(e){e.Duplicate="duplicate",e.Delete="detele",e.Settings="settings"}(S||(S={}));var H=function(){return isNaN(window.RM.shadowBlockAnimSpeed)?.1:window.RM.shadowBlockAnimSpeed},Y=Object(b.d)(s.i).withConfig({displayName:"PageActionsPopup___StyledBox"})(["transform:translateX(",");transition:0.3s transform ease;"],(function(e){return e._css})),W=Object(b.d)(s.i).withConfig({displayName:"PageActionsPopup___StyledBox2"})(["background-color:rgba(40,40,40,0.92);"]),X=Object(a.forwardRef)((function(e,t){var n=e.isShown,r=e.isPageSettingsOpened,a=e.coords,i=e.callback;return n?c.a.createPortal(o.a.createElement(Y,{ref:t,position:"absolute",left:a.x-160,top:a.y-80,zIndex:8e3,_css:r?"-240px":"0px"},o.a.createElement(W,{width:148,height:124,borderRadius:"l",bg:"black",pl:3,pt:12},o.a.createElement(s.i,null,o.a.createElement(s.j,{textStyle:"subheading",color:"white",onClick:function(e){return i(S.Duplicate,e)}},"Duplicate")),o.a.createElement(s.i,{mt:12},o.a.createElement(s.j,{textStyle:"subheading",color:r?"tomato":"white",onClick:function(e){return i(S.Settings,e)}},"Settings")),o.a.createElement(s.i,{mt:12},o.a.createElement(s.j,{textStyle:"subheading",color:"white",onClick:function(e){return i(S.Delete,e)}},"Delete"))),o.a.createElement(s.t,{position:"absolute",top:68,right:-8},o.a.createElement(s.cb,{color:"black"}))),document.body):null}));X.displayName="PageActionsPopup";var V=X,J=n("OTSC"),Q=Object(b.d)(s.I).withConfig({displayName:"PageScreenshot___StyledPicture"})(["border-radius:4px;opacity:",";filter:blur(",");"],(function(e){return e._css}),(function(e){return e._css2})),Z=function(e){var t=e.url,n=e.opacity,r=e.blur,a=void 0!==r&&r;if(!t)return null;var i=t,c=t.split("."),l=c[c.length-2].split("_");if(l.length<=1||isNaN(+l[l.length-1])){var u=J.default.screenshotSize(256);i=J.default.addFilenameComponent(t,u)}return o.a.createElement(s.i,{width:"100%",height:"100%",position:"relative"},o.a.createElement(Q,{width:"100%",height:"100%",src:i,_css:void 0!==n?n:1,_css2:a?"1px":0}),o.a.createElement(s.i,{width:"100%",height:"100%",position:"absolute",top:0,left:0}))};function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ee=Object(b.d)(s.i).withConfig({displayName:"PageListItem___StyledBox"})(["user-select:",";"],(function(e){return e._css})),te=Object(b.d)(s.t).withConfig({displayName:"PageListItem___StyledFlex"})(["cursor:pointer;z-index:1;transform:rotate(",") translateX(",");transition:transform 200ms ease;"],(function(e){return e._css2}),(function(e){return e._css3})),ne=Object(b.d)(s.i).withConfig({displayName:"PageListItem___StyledBox2"})(["box-shadow:",";cursor:pointer;:hover{.page-actions-popup{opacity:",";display:",";}.page-actions-button{opacity:",";display:",";}}transform-origin:left;transform:scale(",");"],(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6}),(function(e){return e._css7}),(function(e){return e._css8}),(function(e){return e._css9})),re=Object(b.d)(s.ab).withConfig({displayName:"PageListItem___StyledText"})(["float:left;"]),ae=Object(b.d)(s.x).withConfig({displayName:"PageListItem___StyledInlineInput"})(["width:","px;height:auto;padding:0;text-overflow:ellipsis;&:focus{border:none;}"],(function(e){return e._css10})),oe=Object(b.d)(s.x).withConfig({displayName:"PageListItem___StyledInlineInput2"})(["width:","px;height:auto;padding:0;text-overflow:ellipsis;&:focus{border:none;}"],(function(e){return e._css11})),ie=o.a.memo((function(e){var t=e.page,n=e.gridSize,i=e.level,c=void 0===i?0:i,l=e.head,u=e.isCmdPressed,d=e.onCollapsed,p=e.isPageCollapsed,g=void 0===p||p,m=Object(a.useContext)(Rn),h=Object(a.useContext)(f),b=c?16*c:c,y=$(Object(a.useState)(t.num===m.currentPageNum),2),v=y[0],w=y[1];Object(a.useEffect)((function(){w(t.num===m.currentPageNum)}),[m.currentPageNum]);var j=$(Object(a.useState)((function(){return t.uri?t.uri:""})),2),S=j[0],O=j[1],P=$(Object(a.useState)(null),2),x=P[0],_=P[1],E=$(Object(a.useState)((function(){return t.seo&&t.seo.title?t.seo.title:""})),2),C=E[0],k=E[1];return o.a.createElement(ee,{width:"192px",my:"6px",ml:"".concat(b,"px"),position:"relative",display:n===Pe.Standard?"block":"flex",_css:h.isDragging?"none":"auto"},v&&o.a.createElement(s.i,{width:"6px",height:"6px",borderRadius:"round",bg:"tomato",position:"absolute",top:n===Pe.Standard?60:"25px",left:"-15px",zIndex:1}),l?o.a.createElement(te,{width:12,height:12,position:"absolute",top:n===Pe.Standard?134:14,left:n===Pe.Standard?-3:93,alignItems:"center",justifyContent:"center",onClick:function(){d&&d()},_css2:g?"0deg":"-90deg",_css3:g?Pe.Standard?"3px":"2px":"0px"},o.a.createElement(s.eb,{color:"black"})):null,o.a.createElement(ne,{width:n===Pe.Standard?192:"88px",height:n===Pe.Standard?124:"56px",className:"page-list-item-picture",mb:c?1:"0px",bg:"white",borderRadius:"s",position:"relative",zIndex:1,"data-page-id":t._id,onClick:function(e){e.preventDefault();var t=e.currentTarget.dataset.pageId;t&&(u?h.dispatch({type:r.TogglePageSelection,payload:t}):(w(!0),window.RM.constructorRouter.showWorkspace({id:t})))},_css4:h.selectedPages[t._id]?"0 0 0 4px #f4f4f4, 0 0 0 8px #ec520b":"0 1px 1px rgba(64, 64, 64, 0.32)",_css5:!v&&h.isPageSettingsOpened?0:1,_css6:!v&&h.isPageSettingsOpened?"none":"flex",_css7:!v&&h.isPageSettingsOpened?0:1,_css8:!v&&h.isPageSettingsOpened?"none":"block",_css9:c&&n===Pe.Standard?"0.9":"1"},o.a.createElement(Z,{url:t.screenshot,opacity:t.hidden?.4:1}),o.a.createElement(ce,{isCurrentPage:v,pageId:t._id,isPageHidden:t.hidden,gridSize:n,hidden:!!h.isDragging})),o.a.createElement(s.i,null,o.a.createElement(s.i,{width:"100%",ml:"".concat(n===Pe.Standard?l?16:0:l?24:8,"px"),mt:"".concat(n===Pe.Standard?8:12,"px")},o.a.createElement(re,{textStyle:"small"},t.num,". "),o.a.createElement(ae,{type:"text",textStyle:"small",color:t.seo&&t.seo.title?"black":"darkGray",placeholder:"Page Title",spellCheck:!1,maxLength:128,value:C,onChange:function(e){k(e.target.value)},onBlur:function(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.seo||{title:"",description:"",keywords:""},{title:C}),n=m.pageSave(t._id,{seo:e});!n||n instanceof Error||n.done((function(e){})).fail((function(){}))},_css10:n===Pe.Standard?l||c?156:170:l||c?62:82})),o.a.createElement(s.i,{width:"100%",ml:"".concat(n===Pe.Standard?l&&g?16:0:8,"px"),mt:"-2px"},o.a.createElement(oe,{type:"text",name:"link",textStyle:"small",color:x?"tomato":t.uri?"black":"darkGray",placeholder:"/custom url",spellCheck:!1,value:x||S,onKeyDown:function(e){_(null),13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){var n=/[^A-Za-z0-9_.+-]/g,r=e.currentTarget.value;n.test(r)&&(r=r.replace(n,""));var a=h.validatePageUri(t._id,r);if(a){var o={hyphen:"The link cannot begin or end with a hyphen",onlyNumbers:"The link cannot be numeric",uriLength:"The link’s max length is 128 characters",used:"This link is already used",pageNotFound:"Can't found current page"}[Object.keys(a)[0]];_(o)}else O(r)},onBlur:function(e){if(!x){var n=e.currentTarget.value,r=m.pageSave(t._id,{uri:n});!r||r instanceof Error||r.done((function(e){O(e.uri||"")})).fail((function(){}))}},_css11:n===Pe.Standard?l||c?172:192:l||c?80:96}))))}));ie.displayName="PageListItem";var ce=o.a.memo((function(e){var t=e.isCurrentPage,n=e.pageId,i=e.isPageHidden,c=e.gridSize,s=e.hidden,l=void 0!==s&&s,u=Object(a.useContext)(f),d=Object(a.useContext)(Rn),p=function(e){e.preventDefault(),e.stopPropagation(),d.deletePage(n)},g=function(e){e.preventDefault(),e.stopPropagation(),d.duplicatePage(n).then((function(){})).catch((function(e){console.warn("page dublicate",e)}))},m=function(e){e.preventDefault(),e.stopPropagation(),u.isTrashOpened?(u.dispatch({type:r.ToggleTrash}),setTimeout((function(){u.dispatch({type:r.TogglePageSettings})}),300)):u.dispatch({type:r.TogglePageSettings})};return l?null:c===Pe.Standard?o.a.createElement(de,{isCurrentPage:t,isPageHidden:i,isPageSettingsOpened:u.isPageSettingsOpened,onPageDuplicate:g,onPageSettingsToggle:m,onPageDelete:p}):o.a.createElement(ge,{isCurrentPage:t,isPageHidden:i,isPageSettingsOpened:u.isPageSettingsOpened,onPageDuplicate:g,onPageSettingsToggle:m,onPageDelete:p})}));ce.displayName="PageActionsPanel";var se=Object(b.d)(s.t).withConfig({displayName:"PageListItem___StyledFlex2"})(["opacity:",";transition:opacity 200ms ease;"],(function(e){return e._css12})),le=Object(b.d)(s.M).withConfig({displayName:"PageListItem___StyledRoundButton"})(["opacity:",";"],(function(e){return e._css13})),ue=Object(b.d)(s.M).withConfig({displayName:"PageListItem___StyledRoundButton2"})(["opacity:",";"],(function(e){return e._css14})),de=o.a.memo((function(e){var t=e.isCurrentPage,n=e.isPageSettingsOpened,r=e.onPageDuplicate,i=e.onPageSettingsToggle,c=e.onPageDelete,l=$(Object(a.useState)(!1),2),u=l[0],d=l[1],p=$(Object(a.useState)(!1),2),g=p[0],f=p[1],m=$(Object(a.useState)(!1),2),h=m[0],b=m[1],y=$(Object(a.useState)(!1),2),v=y[0],w=y[1],j=$(Object(a.useState)(!1),2),S=j[0],O=j[1],P=$(Object(a.useState)(!1),2),x=P[0],_=P[1];return o.a.createElement(se,{className:"page-actions-popup",width:128,height:32,justifyContent:"space-between",position:"absolute",bottom:8,left:32,_css12:t?"1":"0"},o.a.createElement(s.i,null,o.a.createElement(le,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,disabled:n,onClick:r,onMouseEnter:function(){return d(!0)},onMouseLeave:function(){g&&f(!1),d(!1)},onMouseDown:function(){return f(!0)},onMouseUp:function(){return f(!1)},_css13:n?.2:1},o.a.createElement(s.p,{color:g?"white":u?"tomato":"black"}))),o.a.createElement(s.i,null,o.a.createElement(s.M,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,"data-active":t&&n,onClick:i,onMouseEnter:function(){return b(!0)},onMouseLeave:function(){v&&w(!1),b(!1)},onMouseDown:function(){return w(!0)},onMouseUp:function(){return w(!1)}},o.a.createElement(s.O,{color:v||t&&n?"white":h?"tomato":"black"}))),o.a.createElement(s.i,null,o.a.createElement(ue,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,disabled:n,onClick:c,onMouseEnter:function(){return O(!0)},onMouseLeave:function(){x&&_(!1),O(!1)},onMouseDown:function(){return _(!0)},onMouseUp:function(){return _(!1)},_css14:n?.2:1},o.a.createElement(s.o,{color:x?"white":S?"tomato":"black"}))))}));de.displayName="PageActionsStandartPanel";var pe=Object(b.d)(s.i).withConfig({displayName:"PageListItem___StyledBox3"})(["opacity:",";transition:opacity 200ms ease;"],(function(e){return e._css15})),ge=o.a.memo((function(e){var t=e.isCurrentPage,n=e.isPageSettingsOpened,r=e.onPageDuplicate,i=e.onPageSettingsToggle,c=e.onPageDelete,l=$(Object(a.useState)(!1),2),u=l[0],d=l[1],p=$(Object(a.useState)(!1),2),g=p[0],f=p[1],m=$(Object(a.useState)(!1),2),h=m[0],b=m[1],y=$(Object(a.useState)({x:0,y:0}),2),v=y[0],w=y[1],j=Object(a.useRef)(null),O=function(e){e.preventDefault(),e.target&&j.current&&!j.current.contains(e.target)&&b(!1)};Object(a.useEffect)((function(){return h?window.addEventListener("click",O):window.removeEventListener("click",O),function(){window.removeEventListener("click",O)}}),[h]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(V,{ref:j,isShown:h,isPageSettingsOpened:n,coords:v,callback:function(e,t){switch(e){case S.Duplicate:b(!1),r(t);break;case S.Delete:b(!1),c(t);break;case S.Settings:i(t)}}}),o.a.createElement(pe,{className:"page-actions-button",width:32,height:32,position:"absolute",top:12,left:7,borderRadius:"round",_css15:t?"1":"0"},o.a.createElement(s.M,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onMouseEnter:function(){return d(!0)},onMouseLeave:function(){g&&f(!1),d(!1)},onMouseDown:function(){return f(!0)},onMouseUp:function(){return f(!1)},onClick:function(e){return function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.getBoundingClientRect();w({x:t.x,y:t.y+t.height/2}),b(!h)}(e)}},o.a.createElement(s.fb,{color:g||h?"white":u?"tomato":"black"}))))}));function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ge.displayName="PageActionsSmallPanel";var he=Object(b.d)(A.a.div).withConfig({displayName:"DraggableItem__DraggingPage"})(["position:absolute;box-sizing:border-box;cursor:pointer;z-index:2;pointer-events:none;user-select:none;-webkit-user-select:none;&:-webkit-drag{cursor:pointer;pointer-events:none;user-select:none;}"]),be="undefined"!=typeof window&&(window.requestAnimationFrame||window.setImmediate)||function(e){return setTimeout(e,0)},ye=Object(b.d)(s.i).withConfig({displayName:"DraggableItem___StyledBox"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);"]),ve=o.a.memo((function(e){var t=Object(a.useContext)(f),n=Object(a.useContext)(Rn),i=Object(a.useRef)(null),s=Object(a.useRef)(null);Object(a.useEffect)((function(){return e.level&&W(!0),function(){Q.cancel()}}),[]);var l=Object(a.useMemo)((function(){return n.settingsBody?n.settingsBody.getBoundingClientRect():{}}),[n.settingsBody]),u=me(Object(A.b)((function(){return{y:0}})),2),d=u[0].y,p=u[1],g=me(Object(a.useState)({offset:0,state:!1}),2),m=g[0],h=g[1],b=o.a.useRef(),y=me(Object(a.useState)(!1),2),v=y[0],w=y[1],j=o.a.useRef(0),S=o.a.useRef(0),O=n.settingsBody;Object(a.useEffect)((function(){return v?P():x(),function(){return x()}}),[v]);var P=function(){!j.current&&v&&m.state&&(j.current=be(_))},x=function(){j.current&&(window.cancelAnimationFrame(j.current),j.current=0,S.current=0)},_=function e(){O&&v&&(O.scrollBy(0,S.current),j.current=be(e))},E=me(Object(a.useState)(null),2),C=E[0],k=E[1],T=me(Object(a.useState)(null),2),N=T[0],D=T[1],B=me(Object(a.useState)(!1),2),Y=B[0],W=B[1],X=o.a.useRef(),V=o.a.useRef(0);Object(a.useEffect)((function(){V.current=e.gridSize===Pe.Small?L:Y?z:M}),[e.gridSize,Y]);var J=function(){C&&(Q.cancel(),C.style.removeProperty("box-shadow"),k(null))},Q=Object(R.a)((function(t,r){var a=n.pagesParams[r];if(!m.state||v||!a||a&&a.children.length&&a.collapsed||e.head)C&&C.style.removeProperty("box-shadow");else if(t&&b.current){var o=b.current.clientY,i=t.getBoundingClientRect();if(o<=i.top||o>=i.bottom)return;C?C.dataset.pageId!==t.dataset.pageId&&(C.style.removeProperty("box-shadow"),t.style.boxShadow="0 0 0 4px #f4f4f4, 0 0 0 ".concat(e.gridSize===Pe.Small?6:8,"px #B8B8B8"),k(t)):(t.style.boxShadow="0 0 0 4px #f4f4f4, 0 0 0 ".concat(e.gridSize===Pe.Small?6:8,"px #B8B8B8"),k(t))}}),800),K=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(e.style.transition="height ".concat(H(),"s linear 0s"),e.style.height="0px",setTimeout((function(){e.remove()}),Math.round(100*parseInt(H())))):e.remove()},q=function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];N&&N.elem&&(K(N.elem,e),D(null))}(),document.querySelectorAll(".drag-shadow-block").forEach((function(e){e.remove()}))},$=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,o=document.createElement("div");return o.className="drag-shadow-block",o.style.width=e.gridSize===Pe.Small?"".concat(U,"px"):"".concat(a?G:F,"px"),o.style.marginTop="6px",o.style.marginBottom="6px",o.style.marginLeft=a?"16px":"0",o.style.boxSizing="border-box",o.style.borderRadius="4px",r?(o.style.height="0px",o.style.transition="height ".concat(H(),"s linear 0s")):o.style.height="".concat(V.current,"px"),{pageId:t,position:n,elem:o}},ee=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=null!==a?a:Y,i=$(e,n,r,o);N&&N.elem&&K(N.elem,r),n===un.After||n===un.AfterOutside?t.after(i.elem):t.before(i.elem),r&&be((function(){i.elem.style.height="".concat(V.current,"px")})),D(i)},te=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.dataset.pageLevel&&+t.dataset.pageLevel?t:t.parentNode;e?e.pageId!==t.dataset.pageId&&e.position!==n?ee(t.dataset.pageId,a,n,!1,r):e.pageId===t.dataset.pageId&&e.position===n||ee(t.dataset.pageId,a,n,!1,r):ee(t.dataset.pageId,t,n,!1,r)},ne=function(){var a=0;if(i.current){a=i.current.getBoundingClientRect().top;var o=n.settingsBody;e.gridSize===Pe.Standard&&o&&o.scrollTop&&o.scrollTop+o.clientHeight>=o.scrollHeight&&(a+=40),Y&&i.current.parentNode&&(i.current.parentNode.style.height="auto",X.current=e.page.parentPage),function(){var t=e.level?i.current:i.current.parentNode;if(t){if(1===n.pages.length||e.page.parentPage&&1===n.pagesParams[e.page.parentPage].children.length)return void ee(e.page._id,t,un.After);var r=n.pages.findIndex((function(t){return t._id===e.page._id})),a=n.pages[r-1];if(a&&a.parentPage===e.page.parentPage)return void ee(a._id,t.previousSibling,un.After);var o=n.pages[r+1];if(o&&o.parentPage===e.page.parentPage)return void ee(o._id,t.nextSibling,un.Before)}ee(e.page._id,i.current.parentNode,un.After)}()}h({offset:a,state:!0}),t.dispatch({type:r.SetDragging,payload:!0})},re=function(){v&&w(!1),b.current=void 0,Q.cancel();var a={changingId:e.page._id};if(C&&C.dataset.pageId?(a.targetId=C.dataset.pageId,a.position=un.Inside):N&&(a.targetId=N.pageId,a.position=N.position),J(),document.querySelectorAll(".page-list-item-picture").forEach((function(e){e.style.removeProperty("box-shadow")})),q(),a.changingId&&a.targetId&&a.position){var o=n.getNewPageOrderElement(a);if(o instanceof Error)return console.warn(o),Error;n.reorderPage(e.page._id,o)}h({offset:0,state:!1}),t.dispatch({type:r.SetDragging,payload:!1})},ae=Object(I.a)((function(r){var a=r.down,o=me(r.movement,2)[1],i=(me(r.direction,2)[1],r.event),c=!t.isPageSettingsOpened&&a,l=o;if(s.current&&m.state&&(b.current=i,l=ce(o),se(o),v||oe(i,s.current)),m.state!==c){var u=n.pagesParams[e.page._id];if(u&&u.children.length&&u.collapsed)return;c?ne():re()}p({y:c?l:0,immediate:c})}),{capture:!0,filterTaps:!0,axis:"y"}),oe=function(t,r){r.hidden=!0;var a=document.elementFromPoint(t.clientX,t.clientY);if(r.hidden=!1,a){var o,i,c=a.closest(".page-list-draggable-item");if(c){if(c&&c.dataset.pageId&&c.dataset.pageId!==e.page._id){var s=c.querySelector(".page-list-item-picture"),l=(o=r.getBoundingClientRect(),i=s.getBoundingClientRect(),o.bottom-o.height/2-(i.bottom-i.height/2));Q(s,c.dataset.pageId);var u=Boolean(c.dataset.pageLevel&&!!parseInt(c.dataset.pageLevel)),d=!1;u!==Y&&(d=!0,u?c.parentNode&&(c.parentNode.style.height="auto",X.current=c.parentNode.dataset.parentId):X.current=void 0,W(u)),l>=0?te(N,c,un.After,d?u:null):l<=0&&te(N,c,un.Before,d?u:null)}}else J(),Y&&function(e,t){if(X.current&&e.target&&e.target.classList.contains("drag-shadow-block")){var r=e.target.parentNode.getBoundingClientRect();if(t.getBoundingClientRect().bottom-r.bottom>5){var a=n.pagesParams[X.current];a&&(X.current=void 0,ee(a.children[a.children.length-1],e.target.parentNode.parentNode,un.AfterOutside,!1,!1),W(!1))}}}(t,r)}},ce=function(e){if(!n.pagesListContainer)return e;var t=n.pagesListContainer.getBoundingClientRect();return m.offset+e<t.top-0?e-(m.offset+e-(t.top-0)):m.offset+V.current+e>t.bottom+0?e-(m.offset+V.current+e-(t.bottom+0)):e},se=function(e){if(n.settingsBody)if(m.offset+e<l.top){var t=Math.ceil((m.offset+e-l.top)/4);n.settingsBody.scrollTop?(S.current=t,v||w(!0)):v&&w(!1)}else if(m.offset+V.current+e>l.bottom){var r=Math.ceil((m.offset+V.current+e-l.bottom)/4);n.settingsBody.scrollTop+n.settingsBody.clientHeight<n.settingsBody.scrollHeight?(S.current=r,v||w(!0)):v&&w(!1)}else v&&w(!1)};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",fe({className:"page-list-draggable-item","data-page-id":e.page._id,"data-page-level":e.level,ref:i},ae(),{style:{boxSizing:"border-box",display:m.state?"none":"block"}}),o.a.createElement(ie,e)),m.state&&n.dragContainer?c.a.createPortal(o.a.createElement(he,{ref:s,style:{transform:d.interpolate((function(e){return"translate(0, ".concat(e,"px)")})),top:m.offset}},o.a.createElement(ye,{width:e.gridSize===Pe.Small?"".concat(U,"px"):"".concat(Y?G:F,"px"),height:"".concat(V.current,"px"),ml:Y?"40px":"24px",bg:"white",borderRadius:"s"},o.a.createElement(Z,{url:e.page.screenshot}))),n.dragContainer):null)}));function we(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ve.displayName="DraggableItem";var je=Object(b.d)(s.i).withConfig({displayName:"Branch___StyledBox"})(["height:",";overflow-x:hidden;transition:height 200ms ease;"],(function(e){return e._css})),Se=o.a.memo((function(e){var t=e.page,n=e.gridSize,r=e.level,i=void 0===r?0:r,c=e.isCmdPressed,l=Object(a.useContext)(Rn),u=we(Object(a.useState)(null),2),d=u[0],p=u[1],g=Object(a.useRef)(null),f=!(!t.children||!t.children.length),m=!l.pagesParams[t._id]||l.pagesParams[t._id].collapsed,h=t.children&&t.children.length?t.children.map((function(e){return e.num_id})).join(";"):"";Object(a.useEffect)((function(){be((function(){g&&g.current&&(g.current.style.height="auto",p(g.current.scrollHeight),g.current.style.removeProperty("height"))}))}),[n,h]),g&&g.current&&g.current.style.removeProperty("height");var b=Object(a.useCallback)((function(){l.setPageCollapse(t._id,!m)}),[t._id,m]);return o.a.createElement(s.i,{position:"relative"},o.a.createElement(ve,{page:t,gridSize:n,level:i,head:f,isCmdPressed:c,onCollapsed:b,isPageCollapsed:m}),t.children&&f?o.a.createElement(je,{className:"page-children-container",ref:g,"data-parent-id":t._id,_css:m?d?"".concat(d,"px"):"auto":"0px"},t.children.map((function(e){return e.children?o.a.createElement(Se,{key:e._id,page:e,gridSize:n,level:i+1,isCmdPressed:c}):o.a.createElement(ve,{key:e._id,page:e,gridSize:n,level:i+1,isCmdPressed:c})}))):null)}));function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Se.displayName="Branch";var Pe,xe=function(e){var t=e.gridSize,n=Object(a.useContext)(f),r=Object(a.useContext)(Rn);Object(a.useEffect)((function(){window.RM.constructorRouter.pageOrder.fixPageOrder(window.RM.constructorRouter.mag)}),[n.isSettingsOpened]);var i=Oe(Object(a.useState)(!1),2),c=i[0];i[1];return o.a.createElement(s.t,{id:"page-list-container",flexDirection:"column",justifyContent:"left",flexWrap:"wrap",px:3,py:"6px"},r.pagesTree.map((function(e){return o.a.createElement(Se,{key:e._id,page:e,isCmdPressed:c,gridSize:t})})))};function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){e[e.Standard=0]="Standard",e[e.Small=1]="Small"}(Pe||(Pe={}));var Ee=Object(b.d)(s.i).withConfig({displayName:"SettingsBody___StyledBox"})(["overflow-x:visible;overflow-y:auto;user-select:",";"],(function(e){return e._css})),Ce=Object(b.d)(s.S).withConfig({displayName:"SettingsBody___StyledStandardGridIcon"})(["cursor:pointer;rect{fill:",";}"],(function(e){return e._css2})),ke=Object(b.d)(s.R).withConfig({displayName:"SettingsBody___StyledSmallGridIcon"})(["cursor:pointer;path{fill:",";}"],(function(e){return e._css3})),Te=function(){var e,t=Object(a.useContext)(Rn),n=_e(Object(a.useState)(Pe.Standard),2),r=n[0],i=n[1];return o.a.createElement(Ee,{id:"project-settings-body",width:1,height:"calc(100% - 72px - 75px)",position:"relative",_css:t?"none":"auto"},o.a.createElement(s.i,{px:3},o.a.createElement(s.i,null,o.a.createElement(s.ab,{color:"black",textStyle:"subheading"},t.project.title||"Project Title")),o.a.createElement(s.i,{mt:"7px",position:"relative"},o.a.createElement(s.ab,{color:"darkGray",textStyle:"small"},(e=t.project).is_published?e.changed?"Unpublished changes":"Published ".concat(N()(e.published).format("MMM D, YYYY")):"Unpublished"),o.a.createElement(s.t,{mt:"14px",onClick:function(){return i((function(e){return e===Pe.Standard?Pe.Small:Pe.Standard}))}},o.a.createElement(s.i,null,o.a.createElement(Ce,{_css2:r===Pe.Standard?"#808080":"#B8B8B8"})),o.a.createElement(s.i,{ml:"1"},o.a.createElement(ke,{_css3:r===Pe.Small?"#808080":"#B8B8B8"}))))),o.a.createElement(xe,{gridSize:r}))},Ne=Object(b.d)(s.t).withConfig({displayName:"PopupBody___StyledFlex"})(["cursor:pointer;"]),Re=Object(b.d)(s.t).withConfig({displayName:"PopupBody___StyledFlex2"})(["cursor:pointer;"]),Ae=Object(b.d)(s.t).withConfig({displayName:"PopupBody___StyledFlex3"})(["background-image:",";background-position:center center;background-repeat:no-repeat;background-size:cover;"],(function(e){return e._css})),Ie=function(e){var t=e.onMyTemplatesClick,n=e.onRmTemplatesClick,r=e.isUserTemplatesLoading,a=e.userTemplatesScreenshot;return o.a.createElement(s.t,{flexDirection:"column",color:"white",pt:3,pl:3,pb:3},o.a.createElement(Ne,{alignItems:"center",onClick:function(e){e.preventDefault(),n()}},o.a.createElement(s.i,{width:88,height:60,borderRadius:"s",bg:"grey"}),o.a.createElement(s.ab,{textStyle:"small",ml:3},"R/m templates")),o.a.createElement(Re,{alignItems:"center",mt:3,onClick:function(e){return function(e){e.preventDefault(),t()}(e)}},o.a.createElement(Ae,{width:88,height:60,borderRadius:"s",justifyContent:"center",alignItems:"center",bg:"grey",_css:a?"url(".concat(a,")"):"none"},!a&&r&&o.a.createElement(s.E,{bgColor:"transparent"})),o.a.createElement(s.ab,{textStyle:"small",ml:3},"My templates")))};function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Be=Object(b.d)(s.i).withConfig({displayName:"MyTemplatesModal___StyledBox"})(["overflow-y:auto;"]),Me=o.a.memo((function(e){var t=e.isShown,n=e.width,r=e.height,i=e.onClose,l=e.isLoading,u=e.children,d=Object(a.useRef)(null),p=De(Object(a.useState)(null),2),g=p[0],f=p[1];return Object(a.useEffect)((function(){return t?f(window.RM.constructorRouter.showBlockLayer(i,{transparent:!0})):g&&window.RM.constructorRouter.hideBlockLayer(g),function(){g&&window.RM.constructorRouter.hideBlockLayer(g)}}),[t]),c.a.createPortal(o.a.createElement(o.a.Fragment,null,t?o.a.createElement(Be,{ref:d,width:"".concat(n,"px"),height:"".concat(r,"px"),position:"absolute",top:"calc(50% - ".concat(r/2,"px)"),left:"calc(50% - ".concat(n/2,"px)"),zIndex:9999,borderRadius:"l",bg:"black"},o.a.createElement(s.N,null,(function(e){var t=e.ref;return o.a.createElement(s.i,{ref:t,width:"100%",height:"100%"},l?o.a.createElement(s.t,{width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},o.a.createElement(s.E,{bgColor:"transparent"})):u)}))):null),document.body)}));Me.displayName="MyTemplatesModal";var ze=Me,Le=n("eQZl");function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ge=function(e){var t=e.getPageAlert,n=e.isShown,r=e.onClose,i=e.addPageFromTemplate,c=Fe(Object(a.useState)(null),2),s=c[0],l=c[1],u=Object(a.useRef)(!1),d=function(e){i(e)},p=function(e){if(e.templates&&e.templates.length&&!u.current){var t=0;u.current=!0,function n(){i(e.templates[t++],!0).then((function(){t!==e.templates.length?n():u.current=!1})).catch((function(){u.current=!1}))}()}};return Object(a.useEffect)((function(){var e=t(),n=new Le.a({router:window.RM.constructorRouter,pagesAlert:e.render,onClose:r,overlayTransparent:!0});n.on("add-page",d),n.on("add-multiple",p),l(n)}),[]),Object(a.useEffect)((function(){s&&(n?s.show():s.hide())}),[n]),o.a.createElement(o.a.Fragment,null)};function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var He=Object(b.d)(s.t).withConfig({displayName:"MyTemplatesModalBody___StyledFlex"})(["align-content:flex-start;overflow-y:auto;"]),Ye=Object(b.d)(s.t).withConfig({displayName:"MyTemplatesModalBody___StyledFlex2"})(["cursor:pointer;"]),We=Object(b.d)(s.t).withConfig({displayName:"MyTemplatesModalBody___StyledFlex3"})(["background-image:url(",");background-position:center center;background-repeat:no-repeat;background-size:cover;cursor:pointer;&:hover{.delete-template-button{opacity:1;}}"],(function(e){return e._css})),Xe=Object(b.d)(s.M).withConfig({displayName:"MyTemplatesModalBody___StyledRoundButton"})(["position:absolute;top:8px;right:8px;opacity:0;transition:opacity 0.15s ease;"]),Ve=function(e){var t=e.templates,n=e.newTemplateTitle,r=e.createNewUserTemplate,i=e.addPageFromTemplate,c=e.deleteUserTemplate,l=Ue(Object(a.useState)(!1),2),u=l[0],d=l[1],p=Ue(Object(a.useState)(!1),2),g=p[0],f=p[1],m=Ue(Object(a.useState)(!1),2),h=m[0],b=m[1];return o.a.createElement(He,{width:"100%",height:"100%",py:"24px",px:"68px",flexWrap:"wrap",borderRadius:"l"},o.a.createElement(Ye,{width:"216px",height:"141px",mb:"24px",mx:"12px",position:"relative",justifyContent:"center",alignItems:"center",bg:"darkGray",borderRadius:"s",onClick:function(e){e.preventDefault(),e.stopPropagation(),u||(d(!0),r().then((function(){d(!1)})).catch((function(){d(!1)})))}},u?o.a.createElement(s.E,{bgColor:"transparent"}):o.a.createElement(s.J,{color:"black"}),o.a.createElement(s.i,{position:"absolute",top:100},o.a.createElement(s.ab,{textStyle:"small",textAlign:"center"},n))),t.map((function(e){return o.a.createElement(We,{key:e.id,width:"216px",height:"141px",mb:"24px",mx:"12px",position:"relative",bg:"darkGray",borderRadius:"s",onClick:function(t){return function(e,t){e.preventDefault(),e.stopPropagation(),i({template:t.id,custom:!0,specialScreenshot:t.screenshot})}(t,e)},_css:e.thumb},o.a.createElement(Xe,{size:32,className:"delete-template-button",color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onMouseEnter:function(){return f(e.id)},onMouseLeave:function(){h&&b(!1),f(!1)},onMouseDown:function(){return b(e.id)},onMouseUp:function(){return b(!1)},onClick:function(t){return function(e,t){e.preventDefault(),e.stopPropagation(),c(t)}(t,e.id)}},o.a.createElement(s.o,{color:h&&h===e.id?"white":g&&g===e.id?"tomato":"black"})))})))};function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Qe=o.a.memo((function(e){var t=e.isTrashOpened,n=e.isSettingsOpened,r=Object(a.useContext)(Rn),i=Je(Object(a.useState)(!1),2),c=i[0],l=i[1],u=Je(Object(a.useState)(!1),2),d=u[0],p=u[1],f=Je(Object(a.useState)(!1),2),m=f[0],h=f[1],b=Je(Object(a.useState)(!1),2),v=b[0],w=b[1],j=y(c,(function(){l(!1)}));Object(a.useEffect)((function(){n&&c&&(w(!0),r.getUserTemplates().then((function(){w(!1)})).catch((function(e){w(!1),e&&console.warn(e.message)})))}),[n,c]);var S=Object(a.useMemo)((function(){var e=r.pages.find((function(e){return e.num===r.currentPageNum}));return e&&e.title?e.title:"page ".concat(r.currentPageNum)}),[r.currentPageNum]),P=function(e,t){return r.addNewPage(r.currentPageNum,e,t)};return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.j,{color:c?"tomato":"darkGray",textStyle:"small",onClick:function(e){e.preventDefault(),l(!c)}},"Add"),o.a.createElement(O,{ref:j,width:224,height:168,isShown:c,coords:{right:8,bottom:80},transform:t?"translateX(-240px)":"translateX(0px)",placement:g.Bottom},o.a.createElement(Ie,{onRmTemplatesClick:function(){l(!1),h(!0)},onMyTemplatesClick:function(){l(!1),p(!0)},isUserTemplatesLoading:v,userTemplatesScreenshot:r.userTemplates.length?r.userTemplates[0].thumb:void 0})),o.a.createElement(ze,{width:880,height:576,isShown:d,onClose:function(){l(!1),p(!1)},isLoading:v},o.a.createElement(Ve,{templates:r.userTemplates,newTemplateTitle:"Create template from ".concat(S),createNewUserTemplate:r.createTemplateFromCurrentPage,addPageFromTemplate:P,deleteUserTemplate:r.deleteUserTemplate})),o.a.createElement(Ge,{isShown:m,onClose:function(){l(!1),h(!1)},addPageFromTemplate:P,getPageAlert:r.getPageAlert}))}));Qe.displayName="AddFromTemplatesButton";var Ze=Qe,Ke=n("YqYG"),qe=function(){var e=Object(a.useContext)(f),t=Object(a.useContext)(Rn),n=Object(a.useRef)(new Ke.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:t.project.user?t.project.user.email:""},alert_source:"custom sharing"})).current;return o.a.createElement(s.i,{width:1,height:80,position:"absolute",left:0,bottom:0},o.a.createElement(s.i,{position:"absolute",left:24,bottom:36},o.a.createElement(Ze,{isTrashOpened:e.isTrashOpened,isSettingsOpened:e.isSettingsOpened})),o.a.createElement(s.j,{position:"absolute",left:107,bottom:31},o.a.createElement(s.J,{onClick:function(e){e.preventDefault(),t.addNewPage(t.currentPageNum).then((function(){})).catch((function(e){e&&e.err&&"permission_denied"===e.err&&n.render()}))}})),(t.project.has_deleted_pages||e.isTrashOpened)&&o.a.createElement(s.j,{color:e.isTrashOpened?"tomato":"darkGray",textStyle:"small",position:"absolute",right:24,bottom:36,onClick:function(n){n.preventDefault(),(t.project.has_deleted_pages||e.isTrashOpened)&&e.dispatch({type:r.ToggleTrash})}},e.isTrashOpened?"Close":"Bin"))},$e=n("za5s");function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var tt=b.d.div.withConfig({displayName:"Trash__TrashSidebar"})(["height:100%;width:240px;padding:12px 22px;box-sizing:border-box;position:fixed;top:0;right:0;bottom:0;z-index:4000;background-color:",";overflow-x:hidden;overflow-y:auto;transform:translateX( "," );transition:transform 300ms ease;"],Object($e.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isTrashOpened?"0px":"240px":e.isTrashOpened?"480px":"240px"})),nt=o.a.memo((function(){var e=Object(a.useContext)(f),t=Object(a.useContext)(Rn);Object(a.useEffect)((function(){e.isTrashOpened?(document.body.classList.add("trash-is-opened"),t.updateTrash()):document.body.classList.remove("trash-is-opened")}),[e.isTrashOpened]);var n=function(e){return t.restorePage(e)},r=function(e){return t.deletePagesFromTrash([e])};return o.a.createElement(tt,{isTrashOpened:e.isTrashOpened,isSettingsOpened:e.isSettingsOpened},o.a.createElement(s.i,{height:"calc(100% - 80px)",overflow:"auto"},o.a.createElement(s.i,{mb:28},o.a.createElement(s.ab,{color:"white",textStyle:"subheading",textAlign:"left"},"Deleted pages")),t.trashPages.map((function(e){return o.a.createElement(lt,{key:e._id,page:e,isOwner:t.isOwner,onRestorePage:n,onDeletePage:r})}))),t.trashPages.length?o.a.createElement(dt,{onEmptyTrash:function(){t.isOwner&&t.trashPages&&t.emptyTrash()},isOwner:t.isOwner}):null)}));nt.displayName="Trash";var rt=Object(b.d)(s.i).withConfig({displayName:"Trash___StyledBox"})([":hover{.trash-page-actions{opacity:1;}}"]),at=Object(b.d)(s.t).withConfig({displayName:"Trash___StyledFlex"})(["opacity:0;transition:opacity 200ms ease;"]),ot=Object(b.d)(s.t).withConfig({displayName:"Trash___StyledFlex2"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);&:hover{opacity:0.8;}"]),it=Object(b.d)(s.t).withConfig({displayName:"Trash___StyledFlex3"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);transition:opacity 0.2s ease;&:hover{opacity:0.8;}"]),ct=Object(b.d)(s.t).withConfig({displayName:"Trash___StyledFlex4"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);transition:opacity 0.2s ease;&:hover{opacity:0.8;}"]),st=Object(b.d)(s.t).withConfig({displayName:"Trash___StyledFlex5"})(["cursor:",";border:1px solid rgba(128,128,128,0.16);&:hover{opacity:0.8;}"],(function(e){return e._css})),lt=o.a.memo((function(e){var t=e.page,n=e.isOwner,r=e.onRestorePage,i=e.onDeletePage,c=et(Object(a.useState)(!1),2),l=c[0],u=c[1];return o.a.createElement(s.i,{mb:12,ml:"2px"},o.a.createElement(rt,{width:192,height:124,bg:"darkGray",borderRadius:"s",position:"relative"},o.a.createElement(Z,{url:t.screenshot}),o.a.createElement(at,{className:"trash-page-actions",width:176,height:32,justifyContent:"space-between",position:"absolute",left:8,bottom:8},l?o.a.createElement(ot,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"tomato",borderRadius:"xl",onClick:function(e){e.preventDefault(),n&&i(t._id)}},o.a.createElement(s.ab,{textStyle:"small",color:"white"},"Yes")):o.a.createElement(it,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),r(t._id)}},o.a.createElement(s.ab,{textStyle:"small",color:"black"},"Restore")),l?o.a.createElement(ct,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),u(!1)}},o.a.createElement(s.ab,{textStyle:"small",color:"black"},"Cancel")):o.a.createElement(st,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),u(!0)},_css:n?"pointer":"not-allowed"},o.a.createElement(s.ab,{textStyle:"small",color:n?"black":"gray"},"Delete")))),o.a.createElement(s.i,{mt:"7px"},o.a.createElement(s.ab,{textStyle:"small",color:"white"},t.title?t.title:"Page Title")))}));lt.displayName="TrashPage";var ut=Object(b.d)(s.j).withConfig({displayName:"Trash___StyledButton"})(["cursor:",";"],(function(e){return e._css2})),dt=o.a.memo((function(e){var t=e.onEmptyTrash,n=e.isOwner;return o.a.createElement(s.t,{height:80,justifyContent:"center",alignItems:"center",borderTop:"2px solid #B8B8B8",position:"relative",top:12},o.a.createElement(ut,{textStyle:"small",color:n?"white":"gray",onClick:t,_css2:n?"pointer":"not-allowed"},"Empty bin"))}));dt.displayName="TrashFooter";var pt=nt,gt=n("tZHv");function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(n,!0).forEach((function(t){bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yt=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css}),(function(e){return e._css2})),vt=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css3}),(function(e){return e._css4})),wt=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel3"})(["color:",";",";"],(function(e){return e._css5}),(function(e){return e._css6})),jt=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel4"})(["color:",";",";"],(function(e){return e._css7}),(function(e){return e._css8})),St=Object(a.forwardRef)((function(e,t){var n=e.currentPage,r=Object(a.useContext)(f),i=Object(a.useContext)(Rn),c=function(){var e={title:"",description:"",keywords:""};return n&&n.seo&&(e=ht({},e,{},n.seo)),e},l=ft(Object(a.useState)((function(){return c()})),2),u=l[0],d=l[1],p=ft(Object(a.useState)((function(){return n&&n.uri?n.uri:""})),2),g=p[0],m=p[1],h=ft(Object(a.useState)(null),2),b=h[0],y=h[1];Object(a.useEffect)((function(){d(c()),n&&m(n.uri||""),b&&y(null)}),[n]);var v,w,j,S=function(e){var t=e.target,n=t.getAttribute("name");n&&void 0!==u[n]&&d((function(e){return ht({},e,{},bt({},n,t.value))}))},O=function(e){if(n){var t=i.pageSave(n._id,{seo:u});!t||t instanceof Error||t.done((function(e){})).fail((function(){}))}};return o.a.createElement(s.i,{ref:t,mx:24},o.a.createElement(s.i,{mt:"12px"},o.a.createElement(yt,{htmlFor:"title",_css:Object($e.themeGet)("colors.white"),_css2:Object($e.themeGet)("textStyles.small")},"Title"),o.a.createElement(s.y,{name:"title",id:"title",color:"white",placeholder:"Cover",translate:"no",maxLength:128,rows:1,autoSize:!0,mt:"4px",value:u.title,onChange:S,onBlur:O})),o.a.createElement(s.i,{mt:"22px"},o.a.createElement(vt,{htmlFor:"description",_css3:Object($e.themeGet)("colors.white"),_css4:Object($e.themeGet)("textStyles.small")},"Description"),o.a.createElement(s.y,{name:"description",id:"description",color:"white",placeholder:"What's it about...",translate:"no",maxLength:2048,rows:1,autoSize:!0,mt:"4px",value:u.description,onChange:S,onBlur:O})),o.a.createElement(s.i,{mt:"22px"},o.a.createElement(wt,{htmlFor:"keywords",_css5:Object($e.themeGet)("colors.white"),_css6:Object($e.themeGet)("textStyles.small")},"Keywords"),o.a.createElement(s.y,{name:"keywords",id:"keywords",color:"white",placeholder:"Design, fashion",translate:"no",spellCheck:!1,rows:1,autoSize:!0,mt:"4px",value:u.keywords,onChange:S,onBlur:O})),o.a.createElement(s.i,{mt:"22px"},o.a.createElement(jt,{htmlFor:"link",_css7:Object($e.themeGet)("colors.white"),_css8:Object($e.themeGet)("textStyles.small")},(v=i.project,w=gt.a.readymag_host.split("//")[1],j=v.domain,v.user.domain||j||w)),o.a.createElement(s.t,{flexWrap:"wrap"},o.a.createElement(s.ab,{color:"white",fontSize:"small"},function(e){var t=e.domain,n=e.user.domain,r=e.uri,a=e.user.uri;return n?"/"+r+"/":t?"/":"/"+a+"/"+r+"/"}(i.project)),o.a.createElement(s.x,{name:"link",id:"link",type:"text",color:"white",fontSize:"regular",spellCheck:!1,placeholder:n?"/".concat(n.num.toString()):"/",value:b||g,onKeyDown:function(e){y(null),13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){if(n){var t=/[^A-Za-z0-9_.+-]/g,a=e.currentTarget.value;t.test(a)&&(a=a.replace(t,""));var o=r.validatePageUri(n._id,a);if(o){var i={hyphen:"The link cannot begin or end with a hyphen",onlyNumbers:"The link cannot be numeric",uriLength:"The link’s max length is 128 characters",used:"This link is already used",pageNotFound:"Can't found current page"}[Object.keys(o)[0]];y(i)}else m(a)}},onBlur:function(e){if(n&&!b){var t=e.currentTarget.value,r=i.pageSave(n._id,{uri:t});!r||r instanceof Error||r.done((function(e){m(e.uri||"")})).fail((function(){}))}}}))))}));St.displayName="SeoSettings";var Ot=o.a.memo(St),Pt=n("LDvm"),xt=n("+9Qk");function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(n,!0).forEach((function(t){Ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kt(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Nt,Rt=Object(b.d)(s.j).withConfig({displayName:"SocialSettings__CustomizeButton"})(["width:100%;height:40px;border:solid 2px ",";border-radius:32px;"],Object($e.themeGet)("colors.darkGray"));!function(e){e.Default="default",e.Custom="custom",e.Inherited="inherited"}(Nt||(Nt={}));var At=Object(b.d)(s.i).withConfig({displayName:"SocialSettings___StyledBox"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);cursor:pointer;"]),It=Object(b.d)(s.i).withConfig({displayName:"SocialSettings___StyledBox2"})(["background-image:",";background-size:cover;background-repeat:no-repeat;"],(function(e){return e._css})),Dt=Object(b.d)(s.y).withConfig({displayName:"SocialSettings___StyledInlineTextArea"})(["&:disabled{opacity:0.4;}"]),Bt=Object(b.d)(s.y).withConfig({displayName:"SocialSettings___StyledInlineTextArea2"})(["&:disabled{opacity:0.4;}"]),Mt=b.d.label.withConfig({displayName:"SocialSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css2}),(function(e){return e._css3})),zt=Object(b.d)(s.y).withConfig({displayName:"SocialSettings___StyledInlineTextArea3"})(["&:disabled{opacity:0.4;}"]),Lt=b.d.label.withConfig({displayName:"SocialSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css4}),(function(e){return e._css5})),Ft=Object(a.forwardRef)((function(e,t){var n=e.currentPage,r=Object(a.useContext)(Rn),i=new Ke.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-custom-sharing",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:r.project.user?r.project.user.email:""},alert_source:"custom sharing"}),c=Object(a.useMemo)((function(){return!!window.RM.constructorRouter.me&&!!(window.RM.constructorRouter.me.get("permissions")||{}).custom_sharing}),[window.RM.constructorRouter.me]),l=Tt(Object(a.useState)((function(){return r.project.master_share_pid||null})),2),u=l[0],d=l[1],p=function(){var e=n;return e?u?u===e._id?Nt.Custom:Nt.Inherited:e.custom_shares?Nt.Custom:Nt.Default:Nt.Default},g=Tt(Object(a.useState)(p()),2),f=g[0],m=g[1],h=Object(a.useMemo)((function(){return f===Nt.Default||f===Nt.Inherited}),[f]),b=function(e){if(e.custom_shares){var t=e.custom_shares;if(!t.image){var n=J.default.screenshotSize(256),r=J.default.addFilenameComponent(e.screenshot,n);t.image=r}return t}return{description:"",title:"",tweet:"",image:""}},y=function(){var e=r.project.domain||r.project.user&&r.project.user.domain;return xt.a.getDefaultShare(n,r.project,{customDomain:Boolean(e)})},v=function(){var e=n;if(!e)return null;var t=y();if(u){if(u===e._id)return b(e);var a=r.pages.find((function(e){return e._id===u}));if(a)return b(a)}else if(e.custom_shares)return b(e);return t},w=Tt(Object(a.useState)((function(){return v()})),2),j=w[0],S=w[1];Object(a.useEffect)((function(){return S(v()),m(p()),function(){S(null),m(Nt.Default)}}),[n]);var O=function(){if(n)return r.pageSave(n._id,{custom_shares:j})},P=Tt(Object(a.useState)(!1),2),x=P[0],_=P[1],C=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.size>gt.a.UPLOAD_IMAGE_SIZE_LIMIT)){e.next=3;break}return console.error(gt.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),e.abrupt("return");case 3:return _(!0),e.prev=4,e.next=7,Object(Pt.u)("share-upload",t);case 7:(n=e.sent)&&n.picture&&n.picture.url&&j&&(S(Et({},j,{},{image:n.picture.url})),!(r=O())||r instanceof Error||r.done((function(){_(!1)})).fail((function(){}))),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:_(!1);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){kt(o,r,a,i,c,"next",e)}function c(e){kt(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),k=function(e){var t=e.target,n=t.getAttribute("name");n&&j&&void 0!==j[n]&&S((function(e){return Et({},e,{},Ct({},n,t.value))}))},T=function(e){if(j&&n){var t=O();!t||t instanceof Error||t.done((function(){})).fail((function(){}))}},N=Object(a.useMemo)((function(){return Boolean(n&&u&&n._id===u)}),[n,u]),R=function(){if(n){r.pageUnset(n._id,"custom_shares");var e=r.pageSave(n._id,{});!e||e instanceof Error||e.done((function(){S(y()),m(Nt.Default)})).fail((function(){}))}};return o.a.createElement(s.i,{ref:t,mx:24,pb:24},o.a.createElement(s.i,{mt:"12px",position:"relative"},o.a.createElement(s.ab,{color:"white",textStyle:"small"},"OpenGraph"),o.a.createElement(s.i,{position:"absolute",right:0,top:0},o.a.createElement(E,{onClick:function(e){e.preventDefault()}}))),o.a.createElement(s.i,{width:192,height:104,mt:"12px"},o.a.createElement(s.s,{accept:"image/*",dropFile:!0,readFileData:!1,onChange:C,disabled:h},o.a.createElement(At,{width:192,height:104,bg:"darkGrey",borderRadius:"s",position:"relative"},x&&o.a.createElement(s.i,{position:"absolute",top:"28px",left:"72px"},o.a.createElement(s.E,{size:"medium",bgColor:"transparent"})),o.a.createElement(It,{width:"100%",height:"100%",borderRadius:"s",_css:j&&j.image?"url(".concat(j.image,")"):"none"})))),o.a.createElement(s.i,null,o.a.createElement(Dt,{name:"title",id:"share-title",placeholder:"Title",translate:"no",maxLength:128,rows:1,autoSize:!0,mt:"4px",color:"white",textStyle:"regular",disabled:h,value:j&&j.title?j.title:void 0,onChange:k,onBlur:T})),o.a.createElement(s.i,{mt:"22px"},o.a.createElement(Bt,{name:"description",id:"share-description",placeholder:"Description",translate:"no",maxLength:2048,autoSize:!0,rows:1,color:"white",textStyle:"regular",disabled:h,value:j&&j.description?j.description:void 0,onChange:k,onBlur:T})),o.a.createElement(s.i,{mt:"22px"},o.a.createElement(Mt,{htmlFor:"share-tweet",_css2:Object($e.themeGet)("colors.white"),_css3:Object($e.themeGet)("textStyles.small")},"Tweet message"),o.a.createElement(zt,{name:"tweet",id:"share-tweet",translate:"no",maxLength:116,rows:1,autoSize:!0,mt:"4px",color:"white",textStyle:"regular",disabled:h,value:j&&j.tweet?j.tweet:void 0,onChange:k,onBlur:T})),o.a.createElement(s.t,{mt:"22px",alignItems:"center",justifyContent:"space-between"},o.a.createElement(s.i,{width:"128px"},o.a.createElement(Lt,{htmlFor:"all-pages",_css4:Object($e.themeGet)("colors.white"),_css5:Object($e.themeGet)("textStyles.small")},"Use these sharing settings for all pages")),o.a.createElement(s.Z,{id:"all-pages",name:"all-pages",disabled:h||!function(){return Object(a.useMemo)((function(){return!u||N}),[N,u])},checked:N,onChange:function(e){n&&(e?(d(n._id),r.projectSave({master_share_pid:n._id})):(d(null),r.projectUnset("master_share_pid"),r.projectSave({})))}})),o.a.createElement(Rt,{textStyle:"small",color:"white",mt:"24px",display:f===Nt.Default?"block":"none",onClick:function(e){e.preventDefault(),n&&(c?(f!==Nt.Inherited&&m(Nt.Custom),O()):i.render())}},"Customize"),o.a.createElement(Rt,{textStyle:"small",color:"white",mt:"24px",display:f===Nt.Custom?"block":"none",onClick:function(e){if(e.preventDefault(),u){r.projectUnset("master_share_pid");var t=r.projectSave({});!t||t instanceof Error||t.done((function(){d(null),R()}))}else R()}},"Restore to defaults"),o.a.createElement(Rt,{textStyle:"small",color:"white",mt:"24px",display:f===Nt.Inherited?"block":"none",onClick:function(e){e.preventDefault(),u&&(window.RM.constructorRouter.showWorkspace({id:u}),r.scrollToPage(u))}},"Go to master page"))}));Ft.displayName="SocialSettings";var Gt=o.a.memo(Ft),Ut=n("EcEN");function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(n,!0).forEach((function(t){Wt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Vt=b.d.button.withConfig({displayName:"Accordion__CollapseButton"})(["width:100%;height:100%;box-sizing:border-box;border:0;outline:0;background:transparent;text-align:left;transition:color 200ms,border 200ms;"]),Jt=Object(b.d)(Vt).withConfig({displayName:"Accordion___StyledCollapseButton"})(["padding:",";"],(function(e){return e._css2})),Qt=Object(b.d)(s.i).withConfig({displayName:"Accordion___StyledBox"})(["padding:",";"],(function(e){return e._css})),Zt=Object(b.d)(s.i).withConfig({displayName:"Accordion___StyledBox2"})(["height:",";overflow:hidden;transition:height 300ms ease;"],(function(e){return e._css3})),Kt=function(e){var t=e.title,n=e.open,r=e.customClass,i=e.activeKey,c=e.containerHeight,l=e.count,u=e.onCollapseClick,d=e.outerPadding,p=e.innerPadding,g=e.children,f=Xt(Object(a.useState)(0),2),m=f[0],h=f[1],b=Xt(Object(a.useState)(0),2),y=b[0],v=b[1],w=Xt(Object(a.useState)(Object(Ut.v4)()),1)[0],j=Object(a.useCallback)((function(e){null!==e&&h(e.getBoundingClientRect().height)}),[]);Object(a.useEffect)((function(){c&&l&&v(c-l*m)}),[c]);var S,O=function(){return null===i&&n||i===w};return o.a.createElement(o.a.Fragment,null,o.a.createElement(Qt,{width:"100%",ref:j,position:"relative",_css:d||"0"},o.a.createElement(Jt,{className:(S="collapse-btn "+(O()?"active":"inactive"),r&&(S+=" ".concat(r)),S),onClick:function(){return u&&u(w)},_css2:p||"0"},o.a.createElement(s.ab,{textStyle:"subheading"},t))),o.a.createElement(Zt,{_css3:O()?Number(y)+"px":"0px"},g&&o.a.createElement(s.N,null,(function(e){var t=e.ref;return g(t)}))))},qt=function(e){var t=e.children,n=Xt(Object(a.useState)({containerHeight:0,count:o.a.Children.count(t),activeKey:null}),2),r=n[0],i=n[1],c=Object(a.useCallback)((function(e){null!==e&&i(Yt({},r,{containerHeight:e.getBoundingClientRect().height}))}),[]),l=function(e){i(Yt({},r,{activeKey:e}))};return o.a.createElement(s.i,{width:"100%",height:"100%",ref:c},o.a.Children.map(t,(function(e){if(o.a.isValidElement(e)&&e.type===Kt)return o.a.cloneElement(e,Yt({},r,{onCollapseClick:l}));throw new Error("Only Collapse elements can be children of Accordion")})))};function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var en,tn=b.d.div.withConfig({displayName:"PageSettings__PageSettingsSidebar"})(["height:100%;width:240px;padding:0;box-sizing:border-box;position:fixed;top:0;right:0;bottom:0;z-index:",";background-color:",";overflow:hidden;transform:translateX( "," );transition:transform 300ms ease;.collapse-btn.active{color:",";}.collapse-btn.inactive{color:",";}.collapse-btn.divider{border-top:2px solid ",";}"],D,Object($e.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isPageSettingsOpened?"0":"240px":e.isPageSettingsOpened?"480px":"240px"}),Object($e.themeGet)("colors.white"),Object($e.themeGet)("colors.darkGray"),Object($e.themeGet)("colors.darkGray")),nn=Object(b.d)(s.t).withConfig({displayName:"PageSettings___StyledFlex"})(["cursor:pointer;"]),rn=function(){var e=Object(a.useContext)(f),t=Object(a.useContext)(Rn),n=$t(Object(a.useState)(null),2),i=n[0],c=n[1];Object(a.useEffect)((function(){var n=e.isPageSettingsOpened&&t.pages.find((function(e){return e.num===t.currentPageNum}))||null;return c(n),function(){c(null)}}),[e.isPageSettingsOpened,t.currentPageNum]),Object(a.useEffect)((function(){e.isPageSettingsOpened?document.body.classList.add("page-settings-is-opened"):document.body.classList.remove("page-settings-is-opened")}),[e.isPageSettingsOpened]);return o.a.createElement(tn,{isPageSettingsOpened:e.isPageSettingsOpened,isSettingsOpened:e.isSettingsOpened},o.a.createElement(s.i,{width:"100%",height:"calc(100% - 72px)"},o.a.createElement(qt,null,o.a.createElement(Kt,{title:"Page SEO",outerPadding:"0 24px",innerPadding:"11px 0",open:!0},(function(e){return o.a.createElement(Ot,{ref:e,currentPage:i})})),o.a.createElement(Kt,{title:"Social sharing",outerPadding:"0 24px",innerPadding:"11px 0",customClass:"divider"},(function(e){return o.a.createElement(Gt,{ref:e,currentPage:i})})))),o.a.createElement(nn,{width:"calc(100% - 48px)",height:48,ml:24,mr:24,mb:24,alignItems:"center",justifyContent:"center",bg:"darkGray",borderRadius:25,onClick:function(){e.dispatch({type:r.TogglePageSettings})}},o.a.createElement(s.ab,{textStyle:"regular",color:"white",textAlign:"center"},"Done")))};function an(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){e.connection="connection",e.socket="socket",e.none="none"}(en||(en={}));var on={connection:"Seems there is a connection problem. Changes may not be saved until this\n  alert disappears.",socket:"You have been disconnected from the server.",duplicate:"It seems like you’ve opened this project in another tab or browser. We’ve\n  interrupted this session in order to avoid conflicting copies.",none:"unknown alert"},cn=Object(b.d)(s.M).withConfig({displayName:"ConnectionAlert___StyledRoundButton"})(["display:",";"],(function(e){return e._css})),sn=function(){var e=an(Object(a.useState)(en.none),2),t=e[0],n=e[1],r=function(){return n(en.connection)},i=function(){return n(en.socket)},c=function(){return n(en.none)},l=Object(a.useMemo)((function(){return on[t]}),[t]);return Object(a.useEffect)((function(){return window.RM.constructorRouter.on("showConnectionAlert",r),window.RM.constructorRouter.on("showSocketConnectionAlert",i),window.RM.constructorRouter.on("hideConnectionAlert",c),function(){window.RM.constructorRouter.off("showConnectionAlert",r),window.RM.constructorRouter.off("showSocketConnectionAlert",i),window.RM.constructorRouter.off("hideConnectionAlert",c)}}),[window.RM.constructorRouter]),o.a.createElement(s.db,{text:l,position:"top"},o.a.createElement(cn,{size:56,ml:2,mr:0,color:"tomato",_css:t!==en.none?"flex":"none"},o.a.createElement(s.A,{color:"white"})))};function ln(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var un,dn=Object(b.d)(s.t).withConfig({displayName:"Toolbar___StyledFlex"})(["transition:transform "," ease;transform:translateX(",");"],(function(e){return e._css}),(function(e){return e._css2})),pn=function(e){var t=e.transform;return o.a.createElement(dn,{justifyContent:"space-between",position:"fixed",right:16,bottom:16,zIndex:D,_css:B,_css2:t||"0px"},o.a.createElement(sn,null),o.a.createElement(fn,null),o.a.createElement(bn,null),o.a.createElement(wn,null))},gn=function(e){var t=e.isChanged,n=e.isPublished;return o.a.createElement(pn,null,o.a.createElement(hn,{isPublished:n,show:!n||n&&t,onClick:function(){window.RM.views.toolbar.togglePreview()}}),o.a.createElement(yn,null))},fn=function(){var e=Object(a.useContext)(f),t=Object(a.useContext)(Rn),n=Object(a.useMemo)((function(){return e.inPreview&&(t.project.is_published&&t.project.changed||!t.project.is_published)}),[e.inPreview,t.project.is_published,t.project.changed]);return o.a.createElement(hn,{isPublished:t.project.is_published,show:n,onClick:function(){e.inPreview&&(window.RM.views.toolbar.togglePreview(),e.dispatch({type:r.TogglePreview}),setTimeout((function(){e.dispatch({type:r.ToggleSettingsSidebar}),e.dispatch({type:r.SetProjectSettingsState,payload:!0})}),300))}})},mn=Object(b.d)(s.t).withConfig({displayName:"Toolbar___StyledFlex2"})(["border-radius:30px;cursor:pointer;display:",";"],(function(e){return e._css3})),hn=function(e){var t=e.isPublished,n=e.show,r=e.onClick,i=ln(Object(a.useState)(!1),2),c=i[0],l=i[1];return o.a.createElement(mn,{width:120,height:56,ml:2,justifyContent:"center",alignItems:"center",color:"white",bg:c?"black":"darkGray",onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},onClick:function(){return r()},_css3:n?"flex":"none"},o.a.createElement(s.ab,{textStyle:"regular",textAlign:"center"},t?"Republish":"Publish"))},bn=function(){var e=Object(a.useContext)(f);return o.a.createElement(vn,{inPreview:e.inPreview,isSettingsOpened:e.isSettingsOpened,toggleSettings:function(){e.dispatch({type:r.ToggleSettingsSidebar})},togglePreviewState:function(){e.dispatch({type:r.TogglePreview})}})},yn=function(){return o.a.createElement(vn,{inPreview:!0,isSettingsOpened:!1,toggleSettings:function(){},togglePreviewState:function(){}})},vn=function(e){var t=e.inPreview,n=e.isSettingsOpened,r=e.toggleSettings,a=e.togglePreviewState;return o.a.createElement(Sn,{onClick:function(){n&&r(),window.RM.views.toolbar.togglePreview(),a()}},t?o.a.createElement(s.q,null):o.a.createElement(s.r,{height:"26px",width:"38px"}))},wn=function(){var e=Object(a.useContext)(f),t=Object(a.useContext)(Rn);return o.a.createElement(Sn,{onClick:function(){e.dispatch({type:r.ToggleSettingsSidebar})},hidden:e.inPreview},e.isSettingsOpened?o.a.createElement(s.n,null):o.a.createElement(s.ab,{textStyle:"subheading"},t.currentPageNum))},jn=Object(b.d)(s.t).withConfig({displayName:"Toolbar___StyledFlex3"})(["cursor:pointer;display:",";"],(function(e){return e._css4})),Sn=function(e){var t=e.hidden,n=e.onClick,r=e.children,i=ln(Object(a.useState)(!1),2),c=i[0],s=i[1];return o.a.createElement(jn,{width:56,height:56,ml:2,alignItems:"center",justifyContent:"center",borderRadius:"round",color:"white",bg:c?"black":"darkGray",onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},onClick:n,_css4:t?"none":"flex"},r)},On=Object(b.d)(s.i).withConfig({displayName:"Settings___StyledBox"})(["opacity:",";display:",";transition:opacity 300ms ease;z-index:",";"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3})),Pn=function(e){var t=e.show,n=e.overAll;return o.a.createElement(On,{width:"240px",height:"100%",position:"absolute",top:"0",bottom:"0",bg:"white",_css:t?"0.6":"0",_css2:t?"block":"none",_css3:n?1e3:"auto"})},xn=Object(b.d)(s.i).withConfig({displayName:"Settings___StyledBox2"})(["transform:translateX( "," );transition:transform "," ease;"],(function(e){return e._css4}),(function(e){return e._css5})),_n=function(e){var t=e.projectSettingsPanel,n=Object(a.useContext)(f);Object(a.useEffect)((function(){n.isSettingsOpened?document.body.classList.add("settings-is-shown"):document.body.classList.remove("settings-is-shown")}),[n.isSettingsOpened]);var r=Object(a.useMemo)((function(){return n.isSettingsOpened?n.isTrashOpened||n.isPageSettingsOpened?"-480px":"-240px":"0px"}),[n.isSettingsOpened,n.isTrashOpened,n.isPageSettingsOpened]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(pn,{transform:r}),o.a.createElement(xn,{width:240,height:"100%",position:"fixed",top:"0",right:"0",bottom:"0",zIndex:D,_css4:n.isSettingsOpened?n.isTrashOpened||n.isPageSettingsOpened?"-240px":"0px":"240px",_css5:B},o.a.createElement(s.i,{width:240,height:"100%",p:2,bg:"lightGray",color:"black"},o.a.createElement(s.i,{id:"page-drag-container",position:"absolute",top:"0",left:"0",width:"100%"}),o.a.createElement(k,{projectSettingsPanel:t}),o.a.createElement(Te,null),o.a.createElement(qe,null)),o.a.createElement(Pn,{show:n.isPageSettingsOpened||n.isHelpPopupOpened,overAll:n.isHelpPopupOpened})),o.a.createElement(pt,null),o.a.createElement(rn,null))};function En(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(n,!0).forEach((function(t){Tn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){e.After="after",e.Before="before",e.Inside="inside",e.AfterOutside="afteroutside"}(un||(un={}));var Rn=o.a.createContext({}),An=function e(t,n){var r=[];for(var a in t)if(t[a].parentPage===n){var o=e(t,t[a]._id),i=Object.assign({},t[a]);o.length&&(i.children=o),r.push(i)}else if(void 0===t[a].parentPage){var c=Object.assign({},t[a]);r.push(c)}return r},In=function(e,t){var n={};return e.forEach((function(e){n[e._id]={collapsed:!0,children:e.children?e.children.map((function(e){return e._id})):[]}})),Object.keys(t).forEach((function(e){n[e]&&(n[e].collapsed=t[e].collapsed)})),n},Dn=function(){return["screenshot","title","uri","seo","hidden","custom_shares"].map((function(e){return"change:".concat(e)})).join(" ")},Bn=function(e){var t=e.project,n=e.router,r=e.children,i=Nn(Object(a.useState)(null),2),c=i[0],s=i[1];Object(a.useEffect)((function(){var e=document.querySelector(".settings-container");e&&s(e);var t=document.getElementById("page-list-container"),n=document.getElementById("project-settings-body"),r=document.getElementById("page-drag-container");t&&b((function(e){return kn({},e,{pagesListContainer:t,settingsBody:n,dragContainer:r})}))}),[]);var l=new Ke.default({$parent:document.querySelector("body > .popups"),router:n,opts:{type:"type-more-pages",is_contributor:!n.isOwner,owner_email:t.get("user")?t.get("user").email:""},alert_source:"custom sharing"}),u={projectSet:function(e,n){return t.set(e,n)},projectUnset:function(e,n){return t.unset(e,n)},projectSave:function(e,n){return t.save(e,n)},pageSet:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.set(n,r)},pageUnset:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.unset(n,r)},pageSave:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.save(n,r)},setCurrentPageNum:function(e){b((function(t){return kn({},t,{currentPageNum:e})}))},setInPreview:function(e){b((function(t){return kn({},t,{inPreview:e})}))},setPageCollapse:function(e,t){b((function(n){return kn({},n,{pagesParams:kn({},n.pagesParams,{},Tn({},e,kn({},n.pagesParams[e],{collapsed:t})))})}))},scrollToPage:function(e){p(e)},addNewPage:function(e,r,a){return new Promise((function(o,i){var c=h(e,m.pages,m.pagesTree,m.pagesParams),s=c.newPageNum,l=c.newPageParentId,u={num:s};r&&(u=kn({},u,{},r)),t.addPage(u,(function(e){if(e&&e.err)i(e);else{var c=e;r||(c.isEmptyPage=!0),c.set("parentPage",l),n.pageOrder.reorderPagesAfterAdd({page:c,magId:t.get("_id")}),t.onAdd(c),a||n.showWorkspace({id:c.id}),t.getPage(c.id).requestNewScreenshot((function(){n.trigger("renewScreenshot",c.id)})),a||p(c.id),o(c)}}),!0)}))},duplicatePage:function(e){return new Promise((function(r,a){var o=t.getPage(e);if(!o)return a(new Error("Could not find page"));o.get("mid")||o.save({mid:t.get("_id")},{silent:!0});var i=h(o.get("num"),m.pages,m.pagesTree,m.pagesParams),c=i.newPageNum,s=i.newPageParentId;o.duplicate((function(e){if(e instanceof Error)return"Server error: permission_denied"===e.message&&l.render(),a(e);var o=e;o.set("parentPage",s),n.pageOrder.reorderPagesAfterAdd({page:o,magId:t.get("_id")}),t.onAdd(o),n.gg.guides.model&&(n.gg.guides.model.addPage(o.id,{silent:n.gg.guides.hidden}),n.gg.guides.model.save()),n.showWorkspace({id:o.id}),p(o.id),r(e)}),{num:c})}))},getNewPageOrderElement:function(e){var n=e.changingId,r=e.targetId,a=e.position,o=t.getPage(r),i=m.pagesParams[r],c={id:n,num:1,parentPage:null};if(a===un.Inside){if(!i)return new Error("insert into child element");c.num=o.get("num")+1,c.parentPage=r}else if(a===un.Before)c.parentPage=i?null:o.get("parentPage")||null,c.num=o.get("num");else if(a===un.AfterOutside){if(i)return new Error("insert after outside parent element");var s=m.pagesParams[o.get("parentPage")];if(!s||!s.children)return new Error("can not find parent page for target page");if(s.children.indexOf(r)!==s.children.length-1)return new Error("insert after outside not last child page");c.num=o.get("num")+1}else i&&i.children.length?i.collapsed?(c.num=o.get("num")+1,c.parentPage=r):(c.num=o.get("num")+i.children.length+1,c.parentPage=null):(c.parentPage=i?null:o.get("parentPage")||null,c.num=o.get("num")+1);return c},reorderPage:function(e,r){return new Promise((function(a,o){var i=t.getPage(e);if(i.get("num")===r.num&&i.get("parentPage")===r.parentPage)return a();var c=m.pagesParams[e],s=0;c&&c.children.length&&(s=c&&c.children.length),s&&(c.collapsed?n.pageOrder.removeParentIds(c.children):r.parentPage&&n.pageOrder.updateParentIds(c.children,r.parentPage)),n.pageOrder.reorderAfterDrag(i.get("num"),s,r,t.get("_id"));var l=n.workspace.getPageNum();l!==m.currentPageNum&&n.showWorkspace({num:l}),t.trigger("change:pids",t,t.get("pids")),a()}))},deletePage:function(e){return new Promise((function(r,a){if(n.isPageLocked(e))return a(new Error("This page is locked"));if(1===t.get("pids").length)return a(new Error("Can't delete last page"));var o=t.getPage(e),i=o.get("num"),c=n.workspace.getPageNum()===i,s=m.pagesParams[e],l=[];if(s){var u=m.pagesTree.find((function(t){return t._id===e})),p=[];u&&u.children&&u.children.length&&(p=u.children.map((function(e){return e._id}))),s.collapsed?n.pageOrder.removeParentIds(p):l=En(p)}l.push(o.get("_id")),n.pageOrder.deletePagesFromOrder(l,t.get("_id")),t.deletePages(l,(function(e){e&&e instanceof Error&&(n.pageOrder.load(t),a(e)),c&&d(i),n.removeWorkspace(o.id),r()}))}))},restorePage:function(e){return new Promise((function(r,a){t.restorePage(e,{success:function(e){var a=h(n.workspace.getPageNum(),m.pages,m.pagesTree,m.pagesParams),o=a.newPageNum,i=a.newPageParentId;e.set("num",o),e.set("parentPage",i),n.pageOrder.reorderPagesAfterAdd({page:e,magId:t.get("_id")}),t.onAdd(e),t.save(),n.showWorkspace({id:e.id}),p(e.id),r(e)},error:function(e){var t=JSON.parse(e.responseText);"permission_denied"===t.err&&l.render(),a(t)}},!0)}))},deletePagesFromTrash:function(e){return t.deleteTrashPages(e)},updateTrash:function(){return new Promise((function(e,n){t.get("has_deleted_pages")?t.fetchTrashPages().then((function(t){t&&b((function(e){return kn({},e,{trashPages:t})})),e(t)})):e([])}))},emptyTrash:function(){return t.emptyTrash().then((function(){b((function(e){return kn({},e,{trashPages:[]})}))}))},getUserTemplates:function(){return t.loadUserTemplates().then((function(e){return Array.isArray(e)&&b((function(t){return kn({},t,{userTemplates:e})})),e}))},createTemplateFromCurrentPage:function(){return n.createTemplateFromCurrentPage().then((function(e){return e&&b((function(t){var n=Array.from(t.userTemplates);return n.unshift(e),kn({},t,{userTemplates:n})})),e})).catch((function(e){throw e&&"permission denied"===e.message&&l.render(),e}))},deleteUserTemplate:function(e){return Object(Pt.c)(e).then((function(){b((function(t){return kn({},t,{userTemplates:t.userTemplates.filter((function(t){return t.id!==e}))})}))}))},getPageAlert:function(){return l},showTour:function(){window.RM.analytics&&window.RM.analytics.sendEvent("Constructor Help Open","Tour open"),n.pages.once("show",(function(){n.pages.openTour(!1)})),n.pages.show()}},d=function(e){var t=n.pageOrder.get("order"),r=null;if(e>t.length)r=t[t.length-1].id;else{var a=t.find((function(t){return t.num===e}));a&&(r=a.id)}r?(n.showWorkspace({id:r}),p(r)):n.showWorkspace({num:1})},p=function(e){if(c){var t=c.querySelector('.page-list-draggable-item[data-page-id="'.concat(e,'"]'));t&&t.scrollIntoView({behavior:"smooth"})}},g=function(e){var t=kn({},e.attributes);return delete t.children,t},f=Nn(Object(a.useState)((function(){var e=t.pages.models.map((function(e){return g(e)}));e.sort((function(e,t){return e.num-t.num}));var r=An(e,null);return{project:t.attributes,isOwner:!!n.isOwner,inPreview:!1,pages:e,trashPages:[],userTemplates:[],currentPageNum:n.workspace.getPageNum(),pagesTree:r,pagesParams:In(r,{}),pagesListContainer:null,settingsBody:null,dragContainer:null}})),2),m=f[0],b=f[1],y=function(e,t){e&&b((function(n){var r=e.pages.models.map((function(e){return g(e)})).filter((function(e){return t.includes(e._id)}));r.sort((function(e,t){return e.num-t.num}));var a=An(r,null);return kn({},n,{project:e.attributes,pages:r,pagesTree:a,pagesParams:In(a,n.pagesParams)})}))},v=function(e){e&&(e.changed&&e.changed.pids||b((function(t){return kn({},t,{project:e.attributes})})))},w=function(e){e&&(e.changed&&(e.changed.num||e.changed.parentPage)||b((function(t){var n=j(e,t.pages);n.sort((function(e,t){return e.num-t.num}));var r=An(n,null);return kn({},t,{pages:n,pagesTree:r,pagesParams:In(r,t.pagesParams)})})))},j=function(e,t){var n=m.pages.findIndex((function(t){return t._id===e.get("_id")}));return n>=0?m.pages.map((function(t,r){return r===n?g(e):t})).sort((function(e,t){return e.num-t.num})):t},S=function(e){e&&b((function(t){var n=Array.from(t.trashPages);return n.push(e.attributes),kn({},t,{trashPages:n})}))},O=function(e){e&&b((function(t){var n=Array.from(t.trashPages),r=n.findIndex((function(t){return t._id===e.get("_id")}));return r>-1&&n.splice(r,1),kn({},t,{trashPages:n})}))};Object(a.useEffect)((function(){return t.on("change",v),t.on("change:pids",y),t.pages.on(Dn(),w),t.trashPages.on("add",S),t.trashPages.on("remove",O),function(){t.off("change",v),t.off("change:pids",y),t.pages.off(Dn(),w),t.trashPages.off("add",S),t.trashPages.off("remove",O)}}),[t]);var P=function(e){u.setCurrentPageNum(e.getPageNum())};return Object(a.useEffect)((function(){return n.on("pageChange",P),function(){n.off("pageChange",P)}}),[n]),o.a.createElement(Rn.Provider,{value:kn({},m,{},u)},r)},Mn=function(e){var t=e.model,n=e.router,r=e.children;return o.a.createElement(Bn,{project:t,router:n},o.a.createElement(m,{magModel:t,router:n},r))},zn=function(e){var t=e.model,n=e.domElement,r=e.router,a=e.projectSettingsPanel;c.a.render(o.a.createElement(s.bb,null,o.a.createElement(Mn,{model:t,router:r},o.a.createElement(_n,{projectSettingsPanel:a}))),n)},Ln=function(e){var t=e.domElement,n=e.isChanged,r=e.isPublished;c.a.render(o.a.createElement(s.bb,null,o.a.createElement(gn,{isChanged:n,isPublished:r})),t)},Fn=function(e){c.a.unmountComponentAtNode(e),e&&e.parentNode&&e.parentNode.removeChild(e)};n.d(t,"ReorderPagePosition",(function(){return un})),n.d(t,"ProjectContext",(function(){return Rn})),n.d(t,"ProjectContextProvider",(function(){return Bn})),n.d(t,"SettingsController",(function(){return Mn})),n.d(t,"renderSettings",(function(){return zn})),n.d(t,"renderToolbar",(function(){return Ln})),n.d(t,"destroyElement",(function(){return Fn})),n.d(t,"SettingsActionTypes",(function(){return r})),n.d(t,"SettingsContext",(function(){return f})),n.d(t,"CreateSettingsContextProvider",(function(){return m}))}}]);